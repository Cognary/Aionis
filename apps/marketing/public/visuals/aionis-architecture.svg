<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1120" role="img" aria-labelledby="title desc">
  <title id="title">Aionis Architecture Diagram</title>
  <desc id="desc">Layered Aionis architecture from client ingress to source-of-record kernel, async derivation, recall and policy engine, and production control-plane.</desc>
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#070a12"/>
      <stop offset="100%" stop-color="#05060a"/>
    </linearGradient>
    <linearGradient id="panel" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#141a22"/>
      <stop offset="100%" stop-color="#11161d"/>
    </linearGradient>
    <linearGradient id="accent" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#ff4d00"/>
      <stop offset="100%" stop-color="#22d3ee"/>
    </linearGradient>
    <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M0,0 L10,5 L0,10 z" fill="#22d3ee"/>
    </marker>
    <style>
      .title { fill: #eef2f7; font: 700 44px "Space Grotesk", Arial, sans-serif; letter-spacing: -0.02em; }
      .subtitle { fill: #93a2b5; font: 500 19px "Space Grotesk", Arial, sans-serif; }
      .layer-title { fill: #e6edf6; font: 700 22px "Space Grotesk", Arial, sans-serif; }
      .panel-title { fill: #f4f8ff; font: 700 20px "Space Grotesk", Arial, sans-serif; }
      .label { fill: #c9d4e4; font: 600 16px "Space Grotesk", Arial, sans-serif; }
      .text { fill: #9eb0c8; font: 500 14px "Space Grotesk", Arial, sans-serif; }
      .chip { fill: #ffb38a; font: 600 12px "Space Grotesk", Arial, sans-serif; letter-spacing: 0.02em; }
      .small { fill: #7f94ad; font: 500 12px "Space Grotesk", Arial, sans-serif; }
      .line { stroke: #22d3ee; stroke-width: 2.3; fill: none; marker-end: url(#arrow); }
      .line-soft { stroke: #2f9fbb; stroke-width: 2; fill: none; stroke-dasharray: 8 6; marker-end: url(#arrow); }
      .line-rule { stroke: #f3bf6d; stroke-width: 2; fill: none; marker-end: url(#arrow); }
    </style>
  </defs>

  <rect x="0" y="0" width="1800" height="1120" fill="url(#bg)"/>
  <rect x="38" y="34" width="1724" height="1050" rx="22" fill="none" stroke="#223042" stroke-width="2"/>

  <text x="74" y="92" class="title">Aionis Memory Kernel Architecture</text>
  <text x="74" y="126" class="subtitle">Verifiable / Operable path: Source-of-Record write, async derivation, budgeted recall, policy execution, and production governance.</text>

  <!-- Layer A: Ingress -->
  <g transform="translate(70,170)">
    <rect width="1660" height="150" rx="16" fill="url(#panel)" stroke="#263548"/>
    <text x="22" y="34" class="layer-title">A. Ingress and Interface Layer</text>

    <rect x="22" y="52" width="302" height="78" rx="12" fill="#172130" stroke="#2d4158"/>
    <text x="40" y="82" class="panel-title">Clients and Agents</text>
    <text x="40" y="104" class="text">App / Workflow / Multi-agent runtime</text>

    <rect x="352" y="52" width="322" height="78" rx="12" fill="#172130" stroke="#2d4158"/>
    <text x="370" y="82" class="panel-title">SDK and Adapter Surface</text>
    <text x="370" y="104" class="text">TypeScript SDK | Python SDK | MCP | LangGraph</text>

    <rect x="702" y="52" width="470" height="78" rx="12" fill="#182632" stroke="#2d4158"/>
    <text x="720" y="82" class="panel-title">API Endpoints</text>
    <text x="720" y="104" class="text">/write /find /sessions /events /recall /recall_text</text>

    <rect x="1200" y="52" width="438" height="78" rx="12" fill="#182632" stroke="#2d4158"/>
    <text x="1218" y="82" class="panel-title">Auth and Tenant Boundary</text>
    <text x="1218" y="104" class="text">X-Api-Key / JWT -> tenant_id + scope isolation</text>
  </g>

  <!-- Layer B: Kernel -->
  <g transform="translate(70,350)">
    <rect width="1660" height="230" rx="16" fill="url(#panel)" stroke="#263548"/>
    <text x="22" y="34" class="layer-title">B. Source-of-Record Memory Kernel</text>

    <rect x="22" y="52" width="530" height="158" rx="12" fill="#1a2633" stroke="#2f4458"/>
    <text x="40" y="82" class="panel-title">Commit-chain Write Core</text>
    <text x="40" y="104" class="text">memory_nodes + memory_edges + memory_commits</text>
    <text x="40" y="126" class="text">Deterministic idempotent ids (scope, client_id)</text>
    <text x="40" y="148" class="text">Audit lineage: parent_commit_id -> commit_hash</text>
    <text x="40" y="170" class="chip">SoR only: write availability is non-blocking</text>

    <rect x="580" y="52" width="520" height="158" rx="12" fill="#1a2633" stroke="#2f4458"/>
    <text x="598" y="82" class="panel-title">Graph Organization</text>
    <text x="598" y="104" class="text">Node types: event/entity/topic/rule/evidence/concept</text>
    <text x="598" y="126" class="text">Relations: part_of / related_to / derived_from</text>
    <text x="598" y="148" class="text">URI addressing: aionis://tenant/scope/type/id</text>
    <text x="598" y="170" class="chip">Session + Event as first-class write path</text>

    <rect x="1128" y="52" width="510" height="158" rx="12" fill="#1a2633" stroke="#2f4458"/>
    <text x="1146" y="82" class="panel-title">Persistence Foundation</text>
    <text x="1146" y="104" class="text">Postgres + pgvector (partition-ready schema)</text>
    <text x="1146" y="126" class="text">Indexes for recall path and consistency checks</text>
    <text x="1146" y="148" class="text">Pack export/import for migration + replay</text>
    <text x="1146" y="170" class="chip">Operational safety: replay / dead-letter / repair jobs</text>
  </g>

  <!-- Layer C: Async Derived -->
  <g transform="translate(70,610)">
    <rect width="1060" height="210" rx="16" fill="url(#panel)" stroke="#263548"/>
    <text x="22" y="34" class="layer-title">C. Derived Async Processing Lane</text>

    <rect x="22" y="52" width="250" height="136" rx="12" fill="#192536" stroke="#31465a"/>
    <text x="40" y="82" class="panel-title">Outbox Queue</text>
    <text x="40" y="104" class="text">job type + retries + claim timeout</text>
    <text x="40" y="126" class="text">dead-letter + replay</text>

    <rect x="292" y="52" width="250" height="136" rx="12" fill="#192536" stroke="#31465a"/>
    <text x="310" y="82" class="panel-title">Embedding Backfill</text>
    <text x="310" y="104" class="text">provider adapters + batch/rate limit</text>
    <text x="310" y="126" class="text">READY status lifecycle</text>

    <rect x="562" y="52" width="230" height="136" rx="12" fill="#192536" stroke="#31465a"/>
    <text x="580" y="82" class="panel-title">Topic Cluster</text>
    <text x="580" y="104" class="text">derived_from topic edges</text>
    <text x="580" y="126" class="text">cohesion and coverage signals</text>

    <rect x="812" y="52" width="226" height="136" rx="12" fill="#192536" stroke="#31465a"/>
    <text x="830" y="82" class="panel-title">Compression Rollup</text>
    <text x="830" y="104" class="text">summary + citations retention</text>
    <text x="830" y="126" class="text">token-budget evidence metrics</text>
  </g>

  <!-- Layer D: Recall + Policy -->
  <g transform="translate(1150,610)">
    <rect width="580" height="210" rx="16" fill="url(#panel)" stroke="#263548"/>
    <text x="22" y="34" class="layer-title">D. Recall and Policy Execution</text>

    <rect x="22" y="52" width="270" height="136" rx="12" fill="#192536" stroke="#31465a"/>
    <text x="40" y="82" class="panel-title">Recall Engine (L0/L1/L2)</text>
    <text x="40" y="104" class="text">L0 seed -> L1 graph expand -> L2 context build</text>
    <text x="40" y="126" class="text">local / balanced / global trajectory</text>
    <text x="40" y="148" class="text">budget caps: limit/nodes/edges/ranked</text>

    <rect x="312" y="52" width="246" height="136" rx="12" fill="#192536" stroke="#31465a"/>
    <text x="330" y="82" class="panel-title">Rule and Tool Policy</text>
    <text x="330" y="104" class="text">rules/evaluate -> tools/select -> feedback</text>
    <text x="330" y="126" class="text">winner/conflict explainability</text>
    <text x="330" y="148" class="text">memory -> executable decisions</text>
  </g>

  <!-- Layer E: Control Plane -->
  <g transform="translate(70,850)">
    <rect width="1660" height="190" rx="16" fill="url(#panel)" stroke="#263548"/>
    <text x="22" y="34" class="layer-title">E. Control-plane and Production Governance</text>

    <rect x="22" y="52" width="390" height="118" rx="12" fill="#182736" stroke="#31465a"/>
    <text x="40" y="82" class="panel-title">Throughput Governance</text>
    <text x="40" y="104" class="text">inflight gates + queue caps + tenant quotas</text>
    <text x="40" y="126" class="text">write/recall/embed rate strategies</text>

    <rect x="432" y="52" width="390" height="118" rx="12" fill="#182736" stroke="#31465a"/>
    <text x="450" y="82" class="panel-title">Reliability and Safety Gates</text>
    <text x="450" y="104" class="text">health gate, consistency-check, core production gate</text>
    <text x="450" y="126" class="text">partition-readiness, replay, migration checks</text>

    <rect x="842" y="52" width="390" height="118" rx="12" fill="#182736" stroke="#31465a"/>
    <text x="860" y="82" class="panel-title">Observability and Evidence</text>
    <text x="860" y="104" class="text">trajectory + stage timings + adaptive downgrade traces</text>
    <text x="860" y="126" class="text">compression KPIs + incident bundle artifacts</text>

    <rect x="1252" y="52" width="386" height="118" rx="12" fill="#182736" stroke="#31465a"/>
    <text x="1270" y="82" class="panel-title">Release Artifacts</text>
    <text x="1270" y="104" class="text">GitHub main + npm/pypi SDK + Docker main/standalone</text>
    <text x="1270" y="126" class="text">Docs site and runbook synchronization</text>
  </g>

  <!-- Flow arrows -->
  <path class="line" d="M394 260 L430 260"/>
  <path class="line" d="M744 260 L790 260"/>
  <path class="line" d="M1258 260 L1300 260"/>

  <path class="line" d="M900 322 L900 352"/>
  <path class="line" d="M600 580 L310 645"/>
  <path class="line" d="M855 580 L565 645"/>
  <path class="line" d="M1118 580 L1238 666"/>
  <path class="line-rule" d="M1346 740 L1390 740"/>
  <path class="line-soft" d="M910 740 L910 850"/>
  <path class="line-soft" d="M1450 740 L1450 850"/>

  <!-- Legend -->
  <g transform="translate(1270,178)">
    <rect width="460" height="132" rx="12" fill="#121a24" stroke="#2c3d52"/>
    <text x="18" y="30" class="panel-title">Legend</text>
    <line x1="20" y1="54" x2="86" y2="54" class="line" marker-start=""/>
    <text x="100" y="59" class="small">Primary data plane</text>
    <line x1="20" y1="80" x2="86" y2="80" class="line-soft" marker-start=""/>
    <text x="100" y="85" class="small">Observability / control feedback</text>
    <line x1="20" y1="106" x2="86" y2="106" class="line-rule" marker-start=""/>
    <text x="100" y="111" class="small">Policy execution loop</text>
  </g>

  <rect x="74" y="152" width="520" height="4" fill="url(#accent)" rx="2"/>
</svg>
