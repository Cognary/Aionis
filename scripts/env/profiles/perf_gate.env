# Stable gate profile for production-like performance verification.
# Focus: deterministic SLO pass on 100k scale while keeping auth/rate-limit enabled.

DB_POOL_MAX=96
DB_POOL_IDLE_TIMEOUT_MS=45000
DB_POOL_CONNECTION_TIMEOUT_MS=2000

API_RECALL_MAX_INFLIGHT=1200
API_RECALL_QUEUE_MAX=50000
API_RECALL_QUEUE_TIMEOUT_MS=3000
API_WRITE_MAX_INFLIGHT=320
API_WRITE_QUEUE_MAX=16000
API_WRITE_QUEUE_TIMEOUT_MS=2500

RECALL_RATE_LIMIT_RPS=200
RECALL_RATE_LIMIT_BURST=400
WRITE_RATE_LIMIT_RPS=80
WRITE_RATE_LIMIT_BURST=160
WRITE_RATE_LIMIT_MAX_WAIT_MS=100

TENANT_RECALL_RATE_LIMIT_RPS=400
TENANT_RECALL_RATE_LIMIT_BURST=800
TENANT_WRITE_RATE_LIMIT_RPS=120
TENANT_WRITE_RATE_LIMIT_BURST=240
TENANT_WRITE_RATE_LIMIT_MAX_WAIT_MS=120

RECALL_TEXT_EMBED_RATE_LIMIT_RPS=40
RECALL_TEXT_EMBED_RATE_LIMIT_BURST=80
RECALL_TEXT_EMBED_RATE_LIMIT_MAX_WAIT_MS=300
TENANT_RECALL_TEXT_EMBED_RATE_LIMIT_RPS=80
TENANT_RECALL_TEXT_EMBED_RATE_LIMIT_BURST=160
TENANT_RECALL_TEXT_EMBED_RATE_LIMIT_MAX_WAIT_MS=300

RECALL_TEXT_EMBED_BATCH_ENABLED=true
RECALL_TEXT_EMBED_BATCH_MAX_SIZE=48
RECALL_TEXT_EMBED_BATCH_MAX_WAIT_MS=6
RECALL_TEXT_EMBED_BATCH_MAX_INFLIGHT=16
RECALL_TEXT_EMBED_BATCH_QUEUE_MAX=60000
RECALL_TEXT_EMBED_BATCH_QUEUE_TIMEOUT_MS=6000

MEMORY_RECALL_ADAPTIVE_HARD_CAP_ENABLED=true
MEMORY_RECALL_ADAPTIVE_HARD_CAP_WAIT_MS=1200
MEMORY_RECALL_ADAPTIVE_HARD_CAP_LIMIT=20
MEMORY_RECALL_ADAPTIVE_HARD_CAP_NEIGHBORHOOD_HOPS=1
MEMORY_RECALL_ADAPTIVE_HARD_CAP_MAX_NODES=50
MEMORY_RECALL_ADAPTIVE_HARD_CAP_MAX_EDGES=70
MEMORY_RECALL_ADAPTIVE_HARD_CAP_RANKED_LIMIT=120
MEMORY_RECALL_ADAPTIVE_HARD_CAP_MIN_EDGE_WEIGHT=0.2
MEMORY_RECALL_ADAPTIVE_HARD_CAP_MIN_EDGE_CONFIDENCE=0.2

OUTBOX_POLL_INTERVAL_MS=100
OUTBOX_BATCH_SIZE=100

# Phase-D matrix defaults.
AUTO_ADAPT_RATE_LIMIT=true
MAX_RATE_LIMIT_RETRIES=12
RECALL_CONCURRENCY=1
WRITE_CONCURRENCY=1
BENCH_PACE_MS=100
BENCH_PGOPTIONS='-c enable_bitmapscan=off -c enable_seqscan=off -c hnsw.iterative_scan=strict_order -c hnsw.max_scan_tuples=200000'
PGOPTIONS='-c enable_bitmapscan=off -c enable_seqscan=off -c hnsw.iterative_scan=strict_order -c hnsw.max_scan_tuples=200000'

# Core gate defaults.
PERF_RECALL_CONCURRENCY=1
PERF_WRITE_CONCURRENCY=1
PERF_PACE_MS=100
PERF_PGOPTIONS='-c enable_bitmapscan=off -c enable_seqscan=off -c hnsw.iterative_scan=strict_order -c hnsw.max_scan_tuples=200000'
